{% extends "admin/base_site.html" %}
{% block bootstrap %}
<script>
    $('.collapse').collapse()
</script>
{% endblock %}

{%block content%}
{% block body %}
{% load ngsdbview_extras %}
{% load humanize %}

<!-- for autocompletion -->
<!-- end for autocompletion -->

{%  if exp  %}

<FORM action="/ngsdbview/listexperiments/" method="post">
{% csrf_token %}


<TABLE id="viewtable2">
    <TR><TH id="tableheader">Experiment: {{ exp.name }} </TH></TR>
    <TR><TD>

    <!-- experiment table -->
        <div>
            <TABLE  ><TR><TH>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapse4"> Overview of Experiment:</a>
            </TH></TR></TABLE>
        </div>
        <div id="collapse4" class="panel-collapse expand in" style="height: auto;">
            <TABLE><TR>
                <TD> Name:  {{ exp.name }} </TD>
                <TD>Analysis Version: {{ exp.version }}</TD>
                <TD>Exp. type:  {{ exp.type }}</TD>
                <TD>Collaborator:  {{ exp.collaborator }}</TD>
                <TD>Ref. Genome:  {{ exp.refgenome }}</TD>
                <TD>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse4a"> Notes and Description </a>
                </TD>
                <TD>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse4b"> Samples/Libraries included </a>
                </TD>
                </TR></TABLE>

        <!-- notes and description collapsible -->
            <div id="collapse4a" class="panel-collapse expand in" style="height: auto;">
                <TABLE>
                    <TR><TD>Description:</TD><TD>{{ exp.description }}</TD></TR>
                    <TR><TD> Notes:</TD><TD>{{ exp.notes }}</TD></TR>
                </TABLE>
            </div>

        <!-- Sample/Library details collapsible -->
            <div id="collapse4b" class="panel-collapse expand in" style="height: auto;">
                <TABLE>
                    <TR><TH>Included Samples:</TH></TR>
                    <TR><TD>Included Samples:,</br>(sampleid, </br>lifecyclestage, </br>culture-method, </br>growthphase, </br>treatment, </br>librarycode)</TD>
                        {% for sample in exp.samples.all %}
                        <TD>
                            {{ sample.sampleid }};  </br>
                            {{ sample.lifestage }}; </br>
                            {{ sample.culture_method }}; </br>
                            {{ sample.growthphase }} </br>
                            {{ sample.treatment }} </br>
                            {% for lib in sample.library_set.all %}
                                {{ lib.library_code }}
                            {% endfor %}; </br>
                        </TD>
                        {% endfor %}
                    </TR>
                    <TR><TD></TD></TR>
                    <TR><TH>Library Read count distribution</TH>
                    {% for sample in exp.samples.all %}
                    <TD>
                        {% for lib in sample.library_set.all %}
                            {% for libraryfile in lib.libraryfile_set.all %}
                              <a href="{{ libraryfile.file.url }}"  data-lightbox="exptfiles" data-title="{{ libraryfile.subcategory }}"><img src="{{ libraryfile.file.url }}" height="200" width="200"/></a>
                            {% endfor %}
                        {% endfor %}
                    </TD>
                    {% endfor %}
                    </TR>
                </TABLE>
            </div>

        </div>
<!-- commenting out in DNAseq section. New stuff will replace it soon -->

<!-- Link to various (SNP/somy) analyses -->
<div class="panel-heading" style="background-color: #616770; border-color:#616770; overflow: hidden">
    <a data-toggle="collapse" data-parent="#accordion" href="#analysisLinks"> <h3 class="panel-title" style="text-align: left">Links to analyse DNAseq Data</h3> </a>
</div>
<div id="analysisLinks" class="panel-collapse expand in" style="height: auto;">
    <a href="/ngsdbview/analyze/snp/comparelibs/{{ exp.id }}/" target="_blank">Compare SNPs between two groups of Libraries</a>
</div>

</TABLE> <!-- table for this page -->
{% endif %}
{% endblock %}
{% endblock %}